<!DOCTYPE html>
	<meta charset="utf-8">
	<title> Map Testingg <title>
<style>
.background{
	fill:none;
}
</style>
<body>
	
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
<script src="https://d3js.org/d3-ease.v1.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
<script src="https://d3js.org/d3-selection.v1.min.js"></script>
<script src="https://d3js.org/d3-timer.v1.min.js"></script>
<script src="https://d3js.org/d3-transition.v1.min.js"></script>
<script src="https://d3js.org/d3-drag.v1.min.js"></script>
<script src="https://d3js.org/d3-zoom.v1.min.js"></script>
</script>

var topology = topojson.topology({foo: geojson});
var zoom = d3.zoom();
var width = 700;
    height = 600;
    activeWidth = width * 0.7; 
    activeHeight = height * 0.8;
    active = d3.select(null);

var svg = d3.select("body").append("svg").attr("width", width).attr("height", height);

var g = svg.append("g");

var projection = d3.geo.mercator()
    .center([0, 5 ])
    .scale(200)
    .rotate([-180,0]);

var path = d3.geo.path()
   .projection(projection);

var tip = d3.tip()
    .attr("class", "d3-tip")
    .offset([0,0])
    .html(function(d)) {
          return "<strong>Frequency:</strong> <span style='color:white'>" + d.count + </span>" = "<br/>" + d.country;

// load and display the World
d3.json("docs/world.topojson", function(error, topology){
  svg.call(tip)
if (error) return console.error(error);

// load and display the cities
d3.csv("docs/cities.csv", function(error, data){
  max = d3.max(data, function(d))
  {return +d.counter})
  coloring = d3.scale.linear()
    .domain([0,max])
    .range([2,30])
   
  g.selectAll("circle").data(data).enter().append("circle").on("mouseover", tip.show).on("mouseout", tip.hide).attr("cx", function(d) {
  return projection([d.lon, d.lat])[0];
  }).attr("cy", function(d) {
               return projection([d.lon, d.lat])[1];
       })
       .style("fill", function(d){
          return coloring(+d.counter);})
       .style("r",0)
       .transition()
       .duration(500)
       .delay(function(d, i) {return i*200;})
       .style("r",30);
});

g.selectAll("circle").data(topojson.object(topology, topology.objects.countries).geometries().enter().append("path").attr("d", path)
});

// zoom and pan

svg.call(zoom)

</script>
</body>
</html>
